import { LightningElement, track } from 'lwc';
import searchClients from '@salesforce/apex/clientsDataTable.searchClients';
import getClientDetails from '@salesforce/apex/clientsDataTable.getClientDetails';

const columns = [
    { label: 'Client Id',  fieldName: 'Id' },
    { label: 'Client Name',  fieldName: 'Name' },
    { label: 'Phone',  fieldName: 'Client_Phone__c' },
    { label: 'Email',  fieldName: 'Email__c' }
];

export default class clientSearchingDataTable extends LightningElement {
    @track columns = columns;
    @track data = [];
    @track searchKey = '';

    connectedCallback(){
        getClientDetails()
        .then(result => {
            this.data = result;                
        })
        .catch(error => {
            this.error = error;
        });
    }

    handleSearch(event) {
        this.searchKey = event.target.value;

        searchClients({ searchKey : this.searchKey})
        .then(result => {
            this.data = result;
        })
        .catch(error => {
            this.error = error;
        });
    }
}
